#  -*- coding:utf-8 mode:yaml -*-
#  Ansible playbook
#  Copyright 2020 Takeharu KATO All Rights Reserved.
#
#  Kubernetes管理系コンポーネントのデプロイ
#  Control plane + Worker構築後に実行することを想定
#  inventory/hosts の k8s_management グループに登録されたホストで実行される
#
- name: Configure k8s control planes after installation.
  hosts: k8s_management
  remote_user: '{{ ansible_user }}'
  become: true
  roles:
    - role: k8s-hubble-ui
      tags: k8s-hubble-ui
      when: hubble_ui_enabled | default(false)
    - role: k8s-virtual-cluster
      tags: k8s-virtual-cluster
      when: virtualcluster_enabled | default(false)
