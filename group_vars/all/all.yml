#  -*- coding:utf-8 mode:yaml -*-
#  Ansible playbook
#  Copyright 2020 Takeharu KATO All Rights Reserved.
#
# vars/配下のファイルをプレイブックから選択的に読み込むため
# all.ymlには, 設定変更に関わる変数を定義しないこと
# include_vars で読み込んだ変数は一般に play変数レベル で,
# group_vars より高いことが多く, 上書き用に有用であるため。

# ansibleユーザ名
ansible_user: "ansible"
# ansibleのhomeディレクトリ
ansible_home_dir: "/home/{{ ansible_user }}"

#
# 管理用VMデフォルトのネットワークインターフェース
#
# 管理用NICを仮想化環境に応じて自動設定する
# - ESXi/VMware の場合: ens160
# - xcp-ng/xen の場合: enX0
# - それ以外: eth0
# NOTE:
# - gather_facts により ansible_facts.virtualization_type/role が取得できる前提
# - 環境により virtualization_type の表記揺れがあり得るため lower で比較
mgmt_nic: >-
  {{
    (
      (ansible_facts.virtualization_role | default('') | lower) == 'guest'
      and (ansible_facts.virtualization_type | default('') | lower) == 'vmware'
    )
    | ternary(
        'ens160',
        (
          (
            (ansible_facts.virtualization_role | default('') | lower) == 'guest'
            and (ansible_facts.virtualization_type | default('') | lower) in ['xen', 'xcp-ng', 'xcpng']
          )
          | ternary('enX0', 'eth0')
        )
      )
  }}

gpm_mgmt_nic: >-
  {{
    (
      (ansible_facts.virtualization_role | default('') | lower) == 'guest'
      and (ansible_facts.virtualization_type | default('') | lower) == 'vmware'
    )
    | ternary(
        'ens192',
        (
          (
            (ansible_facts.virtualization_role | default('') | lower) == 'guest'
            and (ansible_facts.virtualization_type | default('') | lower) in ['xen', 'xcp-ng', 'xcpng']
          )
          | ternary('ens192', 'eth1')
        )
      )
  }}

#
# === DNS サーバー: 複数ネットワーク逆引きゾーン対応 ===
#
# dns_ipv4_reverse, dns_ipv6_reverse を使用した既存の単一ネットワーク
# 逆引きゾーン生成処理は保持し、以下の internal_network_list で
# 追加ネットワークの逆引きゾーンを生成できます。
#
# internal_network_list の各要素は以下の形式で指定：
#   - ipv4: IPv4 ネットワークアドレス (CIDR 形式、e.g., "192.168.30.0/24")
#   - ipv6: IPv6 プレフィクス (e.g., "fd69:6684:61a:2::/64")
#
# ipv4, ipv6 のいずれか片方があれば処理対象となります。
# 両方指定すると IPv4, IPv6 各々の逆引きゾーンが生成されます。
#
# 注意：
#   - CIDR 形式は必須です (プレフィクス長を含めてください)
#   - 同一ネットワークを重複定義しないでください
#
# 使用例：
#   internal_network_list:
#     - ipv4: "192.168.30.0/24"
#       ipv6: "fd69:6684:61a:2::/64"
#     - ipv4: "192.168.40.0/24"
#     - ipv6: "fd69:6684:61a:3::/64"
#
# デフォルト: 空リスト（追加ネットワークなし）
internal_network_list: []
