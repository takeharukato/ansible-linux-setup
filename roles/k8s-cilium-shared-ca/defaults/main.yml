#  -*- coding:utf-8 mode:yaml -*-
#  Ansible playbook
#  Copyright 2020 Takeharu KATO All Rights Reserved.
#
#  ロール固有変数のデフォルト値
#  group_vars/all/all.yml やhost_varsで上書き可能とするため,
#  ロール名/defaults/main.yml に定義している

# Cilium共通CAのデプロイを有効化するか (デフォルトは無効)
k8s_cilium_shared_ca_enabled: false

# 既存のKubernetes共通CA (k8s-shared-caロール) を流用するか
k8s_cilium_shared_ca_reuse_k8s_ca: false

# Cilium共通CA証明書/鍵の生成先 (自動生成時に使用)
k8s_cilium_shared_ca_cert_filename: "cilium-ca.crt"
k8s_cilium_shared_ca_key_filename: "cilium-ca.key"
k8s_cilium_shared_ca_output_dir: "/etc/kubernetes/pki/cilium-shared-ca"

# ユーザが既存の証明書/鍵を指定する場合のフルパス (指定時はこちらを優先)
k8s_cilium_shared_ca_cert_path: ""
k8s_cilium_shared_ca_key_path: ""

# Secret作成に使用する設定値
k8s_cilium_shared_ca_secret_name: "cilium-ca"
k8s_cilium_shared_ca_secret_namespace: "kube-system"
k8s_cilium_shared_ca_secret_type: "Opaque"
k8s_cilium_shared_ca_secret_cert_key: "ca.crt"
k8s_cilium_shared_ca_secret_key_key: "ca.key"

# Secret適用時に利用するkubeconfigパス
cilium_shared_ca_kubeconfig: "/etc/kubernetes/admin.conf"

# Secretに付与するラベル/アノテーション (必要に応じて上書き)
k8s_cilium_shared_ca_secret_labels:
  "app.kubernetes.io/managed-by": "Helm"
k8s_cilium_shared_ca_secret_annotations:
  "meta.helm.sh/release-name": "cilium"
  "meta.helm.sh/release-namespace": "kube-system"

# 共通CAをロール側で自動生成する設定
k8s_cilium_shared_ca_auto_create: true
k8s_cilium_shared_ca_key_size: 4096
k8s_cilium_shared_ca_valid_days: 3650
k8s_cilium_shared_ca_digest: "sha256"
k8s_cilium_shared_ca_subject: "/CN=Cilium Cluster Mesh CA"

# Cluster Mesh TLS Secret の生成設定
k8s_cilium_clustermesh_secret_enabled: true
k8s_cilium_clustermesh_secret_name: "cilium-clustermesh"
k8s_cilium_clustermesh_secret_namespace: "kube-system"
k8s_cilium_clustermesh_secret_labels:
  "app.kubernetes.io/managed-by": "Helm"
k8s_cilium_clustermesh_secret_annotations:
  "meta.helm.sh/release-name": "cilium"
  "meta.helm.sh/release-namespace": "kube-system"
k8s_cilium_clustermesh_secret_cert_key: "ca.crt"
k8s_cilium_clustermesh_secret_tls_cert_key: "tls.crt"
k8s_cilium_clustermesh_secret_tls_key_key: "tls.key"

# Cluster Mesh TLS 証明書の生成パラメータ
k8s_cilium_clustermesh_tls_cert_filename: "cilium-clustermesh.crt"
k8s_cilium_clustermesh_tls_key_filename: "cilium-clustermesh.key"
k8s_cilium_clustermesh_tls_subject: "/CN=clustermesh-apiserver"
k8s_cilium_clustermesh_tls_san_dns:
  - "clustermesh-apiserver.kube-system.svc.cluster.local"
  - "clustermesh-apiserver.kube-system.svc"
k8s_cilium_clustermesh_tls_valid_days: 3650
k8s_cilium_clustermesh_tls_key_size: 4096
