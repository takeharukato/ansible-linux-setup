#
#  -*- coding:utf-8 mode:bash -*-
# This file is generated by ansible.
{# 日付の取得 #}
# last update: {{ '%Y-%m-%d %H:%M:%S %Z' | strftime(ansible_date_time.epoch) }}

#
# kea-dhcp4 configuration
# 参考) https://www.server-world.info/query?os=Ubuntu_24.04&p=kea&f=1
{
"Dhcp4": {
    "interfaces-config": {
        # リスンするインターフェースを指定
        "interfaces": [ "{{ kea_dhcp_interface }}" ]
    },
    # 期限切れリースの各設定
    "expired-leases-processing": {
        "reclaim-timer-wait-time": {{ kea_reclaim_timer_wait_time }},
        "flush-reclaimed-timer-wait-time": {{ kea_flush_reclaimed_timer_wait_time }},
        "hold-reclaimed-time": {{ kea_hold_reclaimed_time }},
        "max-reclaim-leases": {{ kea_max_reclaim_leases }},
        "max-reclaim-time": {{ kea_max_reclaim_time }},
        "unwarned-reclaim-cycles": {{ kea_unwarned_reclaim_cycles }}
    },
    # 更新プロセスを開始する間隔 (秒)
    "renew-timer": {{ kea_renew_timer_wait_time }},
    # 再バインドプロセスを開始する間隔 (秒)
    "rebind-timer": {{ kea_rebind_timer_wait_time }},
    # リースの有効期間 (秒)
    "valid-lifetime": {{ kea_valid_lifetime }},
    "option-data": [
        {
            # 使用する DNS サーバーを指定
            # 複数指定する場合はカンマ区切り
            "name": "domain-name-servers",
              "data": "{{ kea_dns_servers | join(',') }}"
        },
        {
            # ドメイン名を指定
            "name": "domain-name",
            "data": "{{ kea_domain_name }}"
        },
        {
            # ドメインのサーチベースを指定
            # 複数指定する場合はカンマ区切り
            "name": "domain-search",
            "data": "{{ kea_domain_search | join(',') }}"
        }
    ],
    # リースデータベースの設定
    "lease-database": {
        "type": "{{ kea_lease_db_type }}",
        "persist": true,
        "name": "{{ kea_lease_db_name }}"
    },
    # ipv4サブネットの設定
    "subnet4": [
        {
            "id": 1,
            # DHCP を使用するサブネットを指定
            "subnet": "{{ kea_subnet }}",
            # 貸し出す IP アドレスの範囲を指定
            "pools": [ { "pool": "{{ kea_pool }}" } ],
            "option-data": [
                {
                    # ゲートウェイアドレスを指定
                    "name": "routers",
                    "data": "{{ kea_gateway }}"
                }
            ]
        }
    ],
    # ロギングの設定
    "loggers": [
    {
        "name": "kea-dhcp4",
        "output_options": [
            {
                "output": "{{kea_dhcp_log_file}}",
                "maxsize": {{ kea_dhcp_log_maxsize }},
                "maxver": {{ kea_dhcp_log_maxver }}
            }
        ],
        "severity": "INFO",
        "debuglevel": 0
    }
  ]
}
}